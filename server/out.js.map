{"version":3,"file":null,"sources":["src/validate.js","src/table.js","src/views.js","src/index.js"],"sourcesContent":["import * as Joi from 'joi';\r\n\r\nconst item = Joi.object().keys({\r\n\tclass: Joi.any().only('Variable', 'Fixed'),\r\n\tproduct: Joi.string(),\r\n\tdescription: Joi.string(),\r\n\tquantity: Joi.number(),\r\n\tunit: Joi.string().only('kg', 'each'),\r\n\tentryDate: Joi.date(),\r\n\tlifeSpan: Joi.string().regex(\r\n\t\t/^P(?!$)(\\d+Y)?(\\d+M)?(\\d+W)?(\\d+D)?(T(?=\\d+[HMS])(\\d+H)?(\\d+M)?(\\d+S)?)?$/,\r\n\t\t'ISO 8601 Duration',\r\n\t),\r\n\tlocation: Joi.string(),\r\n\tsalvageValue: Joi.number().integer().allow(null),\r\n\tbarcode: Joi.string(),\r\n\tsupplier: Joi.string().allow(null),\r\n\tsku: Joi.string().allow(null),\r\n});\r\n\r\nexport default Joi.array().items(item).single();\r\n","import { unparse } from 'babyparse';\r\nimport schema from './validate.js';\r\n\r\nexport const fields = [\r\n\t'id',\r\n\t'class',\r\n\t'product',\r\n\t'description',\r\n\t'quantity',\r\n\t'unit',\r\n\t'valuePerUnit',\r\n\t'entryDate',\r\n\t'lifeSpan',\r\n\t'location',\r\n\t'salvageValue',\r\n\t'barcode',\r\n\t'supplier',\r\n\t'sku',\r\n];\r\n\r\nexport default [\r\n\t{\r\n\t\tmethod: 'GET',\r\n\t\tpath: '/table/headers',\r\n\t\thandler(request, reply) {\r\n\t\t\tconst response = request.query.reverse != null\r\n\t\t\t\t? fields.reduce((obj, field, i) => { obj[field] = i; return obj; }, {})\r\n\t\t\t\t: fields.reduce((obj, field, i) => { obj[i] = field; return obj; }, {});\r\n\r\n\t\t\treturn reply(response).type('application/json');\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tmethod: 'GET',\r\n\t\tpath: '/json',\r\n\t\thandler(request, reply) {\r\n\r\n\t\t},\r\n\t\tconfig: {\r\n\t\t\tresponse: { schema },\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tmethod: 'GET',\r\n\t\tpath: '/table',\r\n\t\thandler(request, reply) {\r\n\t\t\t// TODO get data\r\n\t\t\treturn reply(unparse(data, { newline: '\\n' })).type('text/csv');\r\n\t\t},\r\n\t},\r\n\t{\r\n\t\tmethod: 'POST',\r\n\t\tpath: '/table',\r\n\t\thandler(request, reply) {\r\n\t\t\t// TODO parse patch to update database\r\n\t\t},\r\n\t\tconfig: {\r\n\t\t\tvalidate: {\r\n\t\t\t\tpayload: schema,\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n];\r\n","export default [\r\n\t{\r\n\t\tmethod: 'GET',\r\n\t\tpath: '/{param}',\r\n\t\thandler: { directory: { path: 'server/public' } },\r\n\t\t//config: { files: { relativeTo: __dirname } },\r\n\t},\r\n];\r\n","import { name, version } from '../../package.json';\r\n\r\nimport api from './table.js';\r\nimport views from './views.js';\r\n\r\nexport function register(server, opts, next) {\r\n\tserver.route(api);\r\n\tserver.route(views);\r\n\tnext();\r\n}\r\n\r\nregister.attributes = { name, version };\r\n"],"names":["item","Joi","object","keys","any","only","string","number","date","regex","integer","allow","array","items","single","fields","request","reply","response","query","reverse","reduce","obj","field","i","type","schema","unparse","data","newline","directory","path","register","server","opts","next","route","api","views","attributes","name","version"],"mappings":";;;;;;;;;;AAEA,MAAMA,OAAOC,IAAIC,MAAJ,GAAaC,IAAb,CAAkB;QACvBF,IAAIG,GAAJ,GAAUC,IAAV,CAAe,UAAf,EAA2B,OAA3B,CADuB;UAErBJ,IAAIK,MAAJ,EAFqB;cAGjBL,IAAIK,MAAJ,EAHiB;WAIpBL,IAAIM,MAAJ,EAJoB;OAKxBN,IAAIK,MAAJ,GAAaD,IAAb,CAAkB,IAAlB,EAAwB,MAAxB,CALwB;YAMnBJ,IAAIO,IAAJ,EANmB;WAOpBP,IAAIK,MAAJ,GAAaG,KAAb,CACT,2EADS,EAET,mBAFS,CAPoB;WAWpBR,IAAIK,MAAJ,EAXoB;eAYhBL,IAAIM,MAAJ,GAAaG,OAAb,GAAuBC,KAAvB,CAA6B,IAA7B,CAZgB;UAarBV,IAAIK,MAAJ,EAbqB;WAcpBL,IAAIK,MAAJ,GAAaK,KAAb,CAAmB,IAAnB,CAdoB;MAezBV,IAAIK,MAAJ,GAAaK,KAAb,CAAmB,IAAnB;CAfO,CAAb;;AAkBA,aAAeV,IAAIW,KAAJ,GAAYC,KAAZ,CAAkBb,IAAlB,EAAwBc,MAAxB,EAAf;;ACjBO,MAAMC,SAAS,CACrB,IADqB,EAErB,OAFqB,EAGrB,SAHqB,EAIrB,aAJqB,EAKrB,UALqB,EAMrB,MANqB,EAOrB,cAPqB,EAQrB,WARqB,EASrB,UATqB,EAUrB,UAVqB,EAWrB,cAXqB,EAYrB,SAZqB,EAarB,UAbqB,EAcrB,KAdqB,CAAf;;AAiBP,UAAe,CACd;SACS,KADT;OAEO,gBAFP;SAGSC,OAAR,EAAiBC,KAAjB,EAAwB;QACjBC,WAAWF,QAAQG,KAAR,CAAcC,OAAd,IAAyB,IAAzB,GACdL,OAAOM,MAAP,CAAc,CAACC,GAAD,EAAMC,KAAN,EAAaC,CAAb,KAAmB;OAAMD,KAAJ,IAAaC,CAAb,CAAgB,OAAOF,GAAP;GAAnD,EAAkE,EAAlE,CADc,GAEdP,OAAOM,MAAP,CAAc,CAACC,GAAD,EAAMC,KAAN,EAAaC,CAAb,KAAmB;OAAMA,CAAJ,IAASD,KAAT,CAAgB,OAAOD,GAAP;GAAnD,EAAkE,EAAlE,CAFH;;SAIOL,MAAMC,QAAN,EAAgBO,IAAhB,CAAqB,kBAArB,CAAP;;CATY,EAYd;SACS,KADT;OAEO,OAFP;SAGST,OAAR,EAAiBC,KAAjB,EAAwB,EAHzB;SAMS;YACG,EAAES,MAAF;;CAnBE,EAsBd;SACS,KADT;OAEO,QAFP;SAGSV,OAAR,EAAiBC,KAAjB,EAAwB;;SAEhBA,MAAMU,kBAAQC,IAAR,EAAc,EAAEC,SAAS,IAAX,EAAd,CAAN,EAAwCJ,IAAxC,CAA6C,UAA7C,CAAP;;CA3BY,EA8Bd;SACS,MADT;OAEO,QAFP;SAGST,OAAR,EAAiBC,KAAjB,EAAwB;;EAHzB;SAMS;YACG;YACAS;;;CAtCE,CAAf;;ACpBA,YAAe,CACd;SACS,KADT;OAEO,UAFP;UAGU,EAAEI,WAAW,EAAEC,MAAM,eAAR,EAAb;CAJI,CAAf;;ACKO,SAASC,QAAT,CAAkBC,MAAlB,EAA0BC,IAA1B,EAAgCC,IAAhC,EAAsC;QACrCC,KAAP,CAAaC,GAAb;QACOD,KAAP,CAAaE,KAAb;;;;AAIDN,SAASO,UAAT,GAAsB,EAAEC,IAAF,EAAQC,OAAR,EAAtB;;"}